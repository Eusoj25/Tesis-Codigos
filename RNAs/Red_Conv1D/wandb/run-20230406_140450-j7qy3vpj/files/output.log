wandb: WARNING The save_model argument by default saves the model in the HDF5 format that cannot save custom objects like subclassed models and custom layers. This behavior will be deprecated in a future release in favor of the SavedModel format. Meanwhile, the HDF5 model is saved as W&B files and the SavedModel as W&B Artifacts.
WARNING:tensorflow:Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.0029s vs `on_train_batch_end` time: 0.0046s). Check your callbacks.
Epoch 1/30
38/40 [===========================>..] - ETA: 0s - loss: 0.0239 - mape: 472.6297
40/40 [==============================] - 2s 45ms/step - loss: 0.0233 - mape: 461.1676 - val_loss: 0.0021 - val_mape: 96.5035
Epoch 2/30
37/40 [==========================>...] - ETA: 0s - loss: 0.0021 - mape: 96.7703
40/40 [==============================] - 2s 55ms/step - loss: 0.0020 - mape: 96.7472 - val_loss: 0.0021 - val_mape: 96.5991
Epoch 3/30
26/40 [==================>...........] - ETA: 0s - loss: 0.0021 - mape: 95.9210
40/40 [==============================] - 2s 56ms/step - loss: 0.0020 - mape: 95.4474 - val_loss: 0.0020 - val_mape: 92.8307
Epoch 4/30
32/40 [=======================>......] - ETA: 0s - loss: 0.0016 - mape: 88.8263
40/40 [==============================] - 1s 31ms/step - loss: 0.0015 - mape: 87.6787 - val_loss: 0.0014 - val_mape: 82.7375
Epoch 5/30
34/40 [========================>.....] - ETA: 0s - loss: 0.0011 - mape: 78.5031
40/40 [==============================] - 1s 33ms/step - loss: 0.0011 - mape: 77.7365 - val_loss: 7.5717e-04 - val_mape: 74.9999
Epoch 6/30
31/40 [======================>.......] - ETA: 0s - loss: 6.5602e-04 - mape: 70.7523
40/40 [==============================] - 2s 48ms/step - loss: 6.3673e-04 - mape: 70.3611 - val_loss: 5.6964e-04 - val_mape: 66.1378
Epoch 7/30
33/40 [=======================>......] - ETA: 0s - loss: 5.1530e-04 - mape: 65.2040
40/40 [==============================] - 1s 35ms/step - loss: 5.1477e-04 - mape: 65.0520 - val_loss: 4.9374e-04 - val_mape: 63.2279
Epoch 8/30
39/40 [============================>.] - ETA: 0s - loss: 4.6134e-04 - mape: 61.4736
40/40 [==============================] - 1s 31ms/step - loss: 4.6253e-04 - mape: 61.4345 - val_loss: 4.5470e-04 - val_mape: 59.5911
Epoch 9/30
40/40 [==============================] - ETA: 0s - loss: 4.1640e-04 - mape: 56.4537
40/40 [==============================] - 1s 31ms/step - loss: 4.1640e-04 - mape: 56.4537 - val_loss: 3.9593e-04 - val_mape: 53.2146
Epoch 10/30
31/40 [======================>.......] - ETA: 0s - loss: 3.3059e-04 - mape: 50.4639
wandb: Adding directory to artifact (C:\Users\PAVILION 15-DW001LA\Documents\Tesis\CÃ³digos\RNAs\Red_Convolucional\wandb\run-20230406_140450-j7qy3vpj\files\model-best)... Done. 0.0s
40/40 [==============================] - 1s 30ms/step - loss: 3.2401e-04 - mape: 50.2152 - val_loss: 2.7026e-04 - val_mape: 50.2961
Epoch 11/30
40/40 [==============================] - 1s 34ms/step - loss: 2.1163e-04 - mape: 46.1631 - val_loss: 1.7469e-04 - val_mape: 46.3025
Epoch 12/30
33/40 [=======================>......] - ETA: 0s - loss: 1.4762e-04 - mape: 41.6177
40/40 [==============================] - 1s 30ms/step - loss: 1.4168e-04 - mape: 41.4741 - val_loss: 1.1149e-04 - val_mape: 38.9861
Epoch 13/30
33/40 [=======================>......] - ETA: 0s - loss: 9.4865e-05 - mape: 36.6697
40/40 [==============================] - 1s 36ms/step - loss: 9.3355e-05 - mape: 36.4577 - val_loss: 7.5056e-05 - val_mape: 34.5950
Epoch 14/30
30/40 [=====================>........] - ETA: 0s - loss: 6.9775e-05 - mape: 33.9275
40/40 [==============================] - 2s 51ms/step - loss: 6.6307e-05 - mape: 33.2032 - val_loss: 5.5492e-05 - val_mape: 31.5927
Epoch 15/30
34/40 [========================>.....] - ETA: 0s - loss: 4.9575e-05 - mape: 31.0741
40/40 [==============================] - 1s 28ms/step - loss: 4.9900e-05 - mape: 30.9506 - val_loss: 4.3036e-05 - val_mape: 29.8345
Epoch 16/30
26/40 [==================>...........] - ETA: 0s - loss: 4.1208e-05 - mape: 29.8504
40/40 [==============================] - 1s 34ms/step - loss: 3.9885e-05 - mape: 29.1617 - val_loss: 3.4436e-05 - val_mape: 28.6479
Epoch 17/30
33/40 [=======================>......] - ETA: 0s - loss: 3.2797e-05 - mape: 27.5193
40/40 [==============================] - 1s 29ms/step - loss: 3.2745e-05 - mape: 27.9165 - val_loss: 2.9078e-05 - val_mape: 27.5197
Epoch 18/30
27/40 [===================>..........] - ETA: 0s - loss: 2.8691e-05 - mape: 27.6377
40/40 [==============================] - 1s 29ms/step - loss: 2.7594e-05 - mape: 26.6485 - val_loss: 2.4587e-05 - val_mape: 26.2634
Epoch 19/30
40/40 [==============================] - ETA: 0s - loss: 2.3795e-05 - mape: 25.5121
40/40 [==============================] - 2s 56ms/step - loss: 2.3795e-05 - mape: 25.5121 - val_loss: 2.1226e-05 - val_mape: 25.4091
Epoch 20/30
28/40 [====================>.........] - ETA: 0s - loss: 2.0911e-05 - mape: 25.2842
40/40 [==============================] - 1s 32ms/step - loss: 2.0469e-05 - mape: 24.3155 - val_loss: 1.8612e-05 - val_mape: 24.3910
Epoch 21/30
30/40 [=====================>........] - ETA: 0s - loss: 1.8702e-05 - mape: 24.1941
40/40 [==============================] - 1s 30ms/step - loss: 1.7850e-05 - mape: 23.2526 - val_loss: 1.6222e-05 - val_mape: 23.2910
Epoch 22/30
27/40 [===================>..........] - ETA: 0s - loss: 1.6056e-05 - mape: 22.2947
40/40 [==============================] - 1s 29ms/step - loss: 1.5813e-05 - mape: 22.1870 - val_loss: 1.4727e-05 - val_mape: 22.6302
Epoch 23/30
27/40 [===================>..........] - ETA: 0s - loss: 1.4304e-05 - mape: 21.0784
40/40 [==============================] - 1s 30ms/step - loss: 1.4113e-05 - mape: 21.3339 - val_loss: 1.2888e-05 - val_mape: 21.4673
Epoch 24/30
34/40 [========================>.....] - ETA: 0s - loss: 1.2696e-05 - mape: 20.4706
40/40 [==============================] - 1s 28ms/step - loss: 1.2580e-05 - mape: 20.4739 - val_loss: 1.1944e-05 - val_mape: 20.8022
Epoch 25/30
31/40 [======================>.......] - ETA: 0s - loss: 1.1464e-05 - mape: 18.7199
40/40 [==============================] - 3s 70ms/step - loss: 1.1447e-05 - mape: 19.8121 - val_loss: 1.0713e-05 - val_mape: 20.2215
Epoch 26/30
31/40 [======================>.......] - ETA: 0s - loss: 1.0776e-05 - mape: 19.5313
40/40 [==============================] - 1s 31ms/step - loss: 1.0375e-05 - mape: 19.2200 - val_loss: 9.8132e-06 - val_mape: 19.7393
Epoch 27/30
32/40 [=======================>......] - ETA: 0s - loss: 9.8617e-06 - mape: 19.6215
40/40 [==============================] - 1s 31ms/step - loss: 9.5531e-06 - mape: 18.7840 - val_loss: 9.1052e-06 - val_mape: 19.2091
Epoch 28/30
35/40 [=========================>....] - ETA: 0s - loss: 8.9993e-06 - mape: 18.2705
40/40 [==============================] - 1s 29ms/step - loss: 8.7815e-06 - mape: 18.2723 - val_loss: 8.5080e-06 - val_mape: 18.9449
Epoch 29/30
26/40 [==================>...........] - ETA: 0s - loss: 8.2678e-06 - mape: 17.9369
40/40 [==============================] - 1s 30ms/step - loss: 8.1858e-06 - mape: 17.8749 - val_loss: 7.9380e-06 - val_mape: 18.5144
Epoch 30/30
31/40 [======================>.......] - ETA: 0s - loss: 7.4548e-06 - mape: 16.8096
40/40 [==============================] - 2s 43ms/step - loss: 7.6314e-06 - mape: 17.4820 - val_loss: 7.4602e-06 - val_mape: 18.2268
7/7 [==============================] - 0s 2ms/step - loss: 7.4602e-06 - mape: 18.2268
[7.4602280619728845e-06, 18.226781845092773]
Lo que obtuvo la red fue:
[0.07013077 0.03575355 0.03769585 0.07102099]
El resultado correcto:
[0.0689  0.03495 0.03595 0.0699 ]