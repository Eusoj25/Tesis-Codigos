wandb: WARNING The save_model argument by default saves the model in the HDF5 format that cannot save custom objects like subclassed models and custom layers. This behavior will be deprecated in a future release in favor of the SavedModel format. Meanwhile, the HDF5 model is saved as W&B files and the SavedModel as W&B Artifacts.
WARNING:tensorflow:Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.0052s vs `on_train_batch_end` time: 0.0085s). Check your callbacks.
Epoch 1/30
32/40 [=======================>......] - ETA: 0s - loss: 0.1742 - mape: 1933.8289
wandb: Adding directory to artifact (C:\Users\PAVILION 15-DW001LA\Documents\Tesis\Códigos\RNAs\Red_Convolucional\wandb\run-20230405_232336-u6ds9sah\files\model-best)... Done. 0.0s
40/40 [==============================] - 3s 42ms/step - loss: 0.1683 - mape: 1845.2192 - val_loss: 0.1357 - val_mape: 1444.7173
Epoch 2/30
27/40 [===================>..........] - ETA: 0s - loss: 0.1181 - mape: 1330.2415
40/40 [==============================] - 2s 50ms/step - loss: 0.1093 - mape: 1228.8712 - val_loss: 0.0766 - val_mape: 945.3016
Epoch 3/30
40/40 [==============================] - ETA: 0s - loss: 0.0530 - mape: 755.6409
40/40 [==============================] - 1s 32ms/step - loss: 0.0530 - mape: 755.6409 - val_loss: 0.0287 - val_mape: 531.8619
Epoch 4/30
28/40 [====================>.........] - ETA: 0s - loss: 0.0193 - mape: 437.7816
40/40 [==============================] - 1s 34ms/step - loss: 0.0162 - mape: 392.7695 - val_loss: 0.0060 - val_mape: 239.5033
Epoch 5/30
39/40 [============================>.] - ETA: 0s - loss: 0.0028 - mape: 159.8393
40/40 [==============================] - 1s 37ms/step - loss: 0.0028 - mape: 159.2000 - val_loss: 7.5584e-04 - val_mape: 87.6258
Epoch 6/30
35/40 [=========================>....] - ETA: 0s - loss: 4.8949e-04 - mape: 66.7517
40/40 [==============================] - 1s 33ms/step - loss: 4.8172e-04 - mape: 65.7307 - val_loss: 3.6597e-04 - val_mape: 50.9943
Epoch 7/30
40/40 [==============================] - ETA: 0s - loss: 3.2868e-04 - mape: 49.9993
40/40 [==============================] - 1s 34ms/step - loss: 3.2868e-04 - mape: 49.9993 - val_loss: 3.0198e-04 - val_mape: 46.1539
Epoch 8/30
35/40 [=========================>....] - ETA: 0s - loss: 2.6678e-04 - mape: 45.9471
40/40 [==============================] - 1s 35ms/step - loss: 2.6945e-04 - mape: 46.0959 - val_loss: 2.4892e-04 - val_mape: 43.2269
Epoch 9/30
37/40 [==========================>...] - ETA: 0s - loss: 2.2731e-04 - mape: 43.4932
40/40 [==============================] - 2s 38ms/step - loss: 2.2653e-04 - mape: 43.6461 - val_loss: 2.0202e-04 - val_mape: 41.1547
Epoch 10/30
36/40 [==========================>...] - ETA: 0s - loss: 1.8889e-04 - mape: 40.7909
40/40 [==============================] - 1s 35ms/step - loss: 1.8611e-04 - mape: 41.2282 - val_loss: 1.7054e-04 - val_mape: 38.8937
Epoch 11/30
37/40 [==========================>...] - ETA: 0s - loss: 1.5588e-04 - mape: 38.7046
40/40 [==============================] - 1s 33ms/step - loss: 1.5357e-04 - mape: 39.2367 - val_loss: 1.3380e-04 - val_mape: 37.0734
Epoch 12/30
40/40 [==============================] - ETA: 0s - loss: 1.2593e-04 - mape: 37.3428
40/40 [==============================] - 1s 34ms/step - loss: 1.2593e-04 - mape: 37.3428 - val_loss: 1.0538e-04 - val_mape: 35.4414
Epoch 13/30
38/40 [===========================>..] - ETA: 0s - loss: 1.0080e-04 - mape: 35.4443
40/40 [==============================] - 2s 51ms/step - loss: 1.0054e-04 - mape: 35.5672 - val_loss: 8.4739e-05 - val_mape: 34.5467
Epoch 14/30
35/40 [=========================>....] - ETA: 0s - loss: 8.2331e-05 - mape: 34.3617
40/40 [==============================] - 1s 38ms/step - loss: 8.1210e-05 - mape: 34.0175 - val_loss: 7.1259e-05 - val_mape: 32.5786
Epoch 15/30
38/40 [===========================>..] - ETA: 0s - loss: 6.5754e-05 - mape: 32.2474
40/40 [==============================] - 1s 35ms/step - loss: 6.5710e-05 - mape: 32.4074 - val_loss: 5.6350e-05 - val_mape: 32.0547
Epoch 16/30
40/40 [==============================] - 0s 7ms/step - loss: 5.3787e-05 - mape: 30.9187 - val_loss: 5.8566e-05 - val_mape: 31.0706
Epoch 17/30
40/40 [==============================] - ETA: 0s - loss: 4.5343e-05 - mape: 29.6589
40/40 [==============================] - 1s 33ms/step - loss: 4.5343e-05 - mape: 29.6589 - val_loss: 4.3788e-05 - val_mape: 29.3954
Epoch 18/30
40/40 [==============================] - 1s 34ms/step - loss: 3.9466e-05 - mape: 28.6579 - val_loss: 3.9615e-05 - val_mape: 30.2876
Epoch 19/30
28/40 [====================>.........] - ETA: 0s - loss: 3.6057e-05 - mape: 27.0408
wandb: Adding directory to artifact (C:\Users\PAVILION 15-DW001LA\Documents\Tesis\Códigos\RNAs\Red_Convolucional\wandb\run-20230405_232336-u6ds9sah\files\model-best)... Done. 0.0s
40/40 [==============================] - 1s 38ms/step - loss: 3.5713e-05 - mape: 27.8883 - val_loss: 3.4984e-05 - val_mape: 27.7017
Epoch 20/30
38/40 [===========================>..] - ETA: 0s - loss: 3.2692e-05 - mape: 26.8469
40/40 [==============================] - 1s 33ms/step - loss: 3.2807e-05 - mape: 27.0779 - val_loss: 3.3634e-05 - val_mape: 29.0440
Epoch 21/30
39/40 [============================>.] - ETA: 0s - loss: 3.0387e-05 - mape: 26.4966
40/40 [==============================] - 1s 33ms/step - loss: 3.0316e-05 - mape: 26.4075 - val_loss: 2.8249e-05 - val_mape: 26.2096
Epoch 22/30
34/40 [========================>.....] - ETA: 0s - loss: 2.6489e-05 - mape: 24.7624
40/40 [==============================] - 2s 57ms/step - loss: 2.7393e-05 - mape: 25.4925 - val_loss: 2.5811e-05 - val_mape: 25.3872
Epoch 23/30
27/40 [===================>..........] - ETA: 0s - loss: 2.4290e-05 - mape: 23.8027
40/40 [==============================] - 2s 39ms/step - loss: 2.5089e-05 - mape: 24.7854 - val_loss: 2.3064e-05 - val_mape: 24.7064
Epoch 24/30
40/40 [==============================] - 0s 7ms/step - loss: 2.2529e-05 - mape: 23.8183 - val_loss: 2.3643e-05 - val_mape: 25.6521
Epoch 25/30
37/40 [==========================>...] - ETA: 0s - loss: 1.9674e-05 - mape: 22.6412
40/40 [==============================] - 1s 34ms/step - loss: 2.0141e-05 - mape: 22.9578 - val_loss: 1.7270e-05 - val_mape: 22.4380
Epoch 26/30
36/40 [==========================>...] - ETA: 0s - loss: 1.7330e-05 - mape: 21.4903
40/40 [==============================] - 1s 34ms/step - loss: 1.7387e-05 - mape: 21.7633 - val_loss: 1.4837e-05 - val_mape: 20.9653
Epoch 27/30
39/40 [============================>.] - ETA: 0s - loss: 1.4977e-05 - mape: 20.4853
40/40 [==============================] - 1s 32ms/step - loss: 1.5014e-05 - mape: 20.6429 - val_loss: 1.2455e-05 - val_mape: 19.8126
Epoch 28/30
40/40 [==============================] - 2s 43ms/step - loss: 1.2328e-05 - mape: 19.2549 - val_loss: 1.0831e-05 - val_mape: 18.9106
Epoch 29/30
40/40 [==============================] - 0s 10ms/step - loss: 1.0218e-05 - mape: 18.1585 - val_loss: 1.4613e-05 - val_mape: 21.1302
Epoch 30/30
40/40 [==============================] - 0s 6ms/step - loss: 8.3977e-06 - mape: 17.1234 - val_loss: 1.5418e-05 - val_mape: 20.7166
7/7 [==============================] - 0s 2ms/step - loss: 1.5418e-05 - mape: 20.7166
[1.5418063412653282e-05, 20.71663475036621]
Lo que obtuvo la red fue:
[0.0746932  0.03751716 0.03871256 0.07471383]
El resultado correcto:
[0.0689  0.03495 0.03595 0.0699 ]