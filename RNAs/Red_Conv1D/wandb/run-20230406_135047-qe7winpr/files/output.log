wandb: WARNING The save_model argument by default saves the model in the HDF5 format that cannot save custom objects like subclassed models and custom layers. This behavior will be deprecated in a future release in favor of the SavedModel format. Meanwhile, the HDF5 model is saved as W&B files and the SavedModel as W&B Artifacts.
WARNING:tensorflow:Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.0045s vs `on_train_batch_end` time: 0.0081s). Check your callbacks.
Epoch 1/50
27/40 [===================>..........] - ETA: 0s - loss: 0.1136 - mape: 1400.5319
wandb: Adding directory to artifact (C:\Users\PAVILION 15-DW001LA\Documents\Tesis\Códigos\RNAs\Red_Convolucional\wandb\run-20230406_135047-qe7winpr\files\model-best)... Done. 0.0s
40/40 [==============================] - 2s 49ms/step - loss: 0.0912 - mape: 1208.8298 - val_loss: 0.0258 - val_mape: 592.0491
Epoch 2/50
31/40 [======================>.......] - ETA: 0s - loss: 0.0123 - mape: 389.4918
40/40 [==============================] - 1s 35ms/step - loss: 0.0103 - mape: 348.6365 - val_loss: 0.0020 - val_mape: 159.6005
Epoch 3/50
29/40 [====================>.........] - ETA: 0s - loss: 0.0012 - mape: 117.0477
40/40 [==============================] - 1s 29ms/step - loss: 0.0010 - mape: 105.5672 - val_loss: 5.5618e-04 - val_mape: 73.4867
Epoch 4/50
36/40 [==========================>...] - ETA: 0s - loss: 4.1216e-04 - mape: 59.4196
40/40 [==============================] - 1s 31ms/step - loss: 4.0244e-04 - mape: 59.1520 - val_loss: 2.6750e-04 - val_mape: 48.1213
Epoch 5/50
29/40 [====================>.........] - ETA: 0s - loss: 2.1407e-04 - mape: 43.7640
40/40 [==============================] - 1s 31ms/step - loss: 1.9802e-04 - mape: 42.5435 - val_loss: 1.2643e-04 - val_mape: 35.4098
Epoch 6/50
26/40 [==================>...........] - ETA: 0s - loss: 1.0563e-04 - mape: 35.7946
40/40 [==============================] - 1s 36ms/step - loss: 9.8695e-05 - mape: 34.2706 - val_loss: 6.5042e-05 - val_mape: 31.4558
Epoch 7/50
26/40 [==================>...........] - ETA: 0s - loss: 5.8390e-05 - mape: 28.8963
40/40 [==============================] - 1s 30ms/step - loss: 5.1810e-05 - mape: 28.7220 - val_loss: 5.4193e-05 - val_mape: 29.2984
Epoch 8/50
40/40 [==============================] - ETA: 0s - loss: 2.7627e-05 - mape: 23.4824
40/40 [==============================] - 1s 34ms/step - loss: 2.7627e-05 - mape: 23.4824 - val_loss: 2.8574e-05 - val_mape: 21.8003
Epoch 9/50
27/40 [===================>..........] - ETA: 0s - loss: 1.5482e-05 - mape: 19.1749
40/40 [==============================] - 1s 30ms/step - loss: 1.4215e-05 - mape: 18.4632 - val_loss: 1.0905e-05 - val_mape: 17.4055
Epoch 10/50
27/40 [===================>..........] - ETA: 0s - loss: 1.0493e-05 - mape: 16.7245
40/40 [==============================] - 1s 34ms/step - loss: 1.0056e-05 - mape: 15.7907 - val_loss: 8.1183e-06 - val_mape: 15.5091
Epoch 11/50
40/40 [==============================] - 0s 8ms/step - loss: 6.4729e-06 - mape: 12.4864 - val_loss: 9.1863e-06 - val_mape: 12.9156
Epoch 12/50
40/40 [==============================] - 1s 30ms/step - loss: 4.2742e-06 - mape: 8.5064 - val_loss: 1.7853e-06 - val_mape: 7.7233
Epoch 13/50
34/40 [========================>.....] - ETA: 0s - loss: 3.7075e-06 - mape: 7.4517
wandb: Adding directory to artifact (C:\Users\PAVILION 15-DW001LA\Documents\Tesis\Códigos\RNAs\Red_Convolucional\wandb\run-20230406_135047-qe7winpr\files\model-best)... Done. 0.0s
40/40 [==============================] - 2s 42ms/step - loss: 3.9936e-06 - mape: 7.1890 - val_loss: 1.0210e-06 - val_mape: 6.6311
Epoch 14/50
40/40 [==============================] - 0s 7ms/step - loss: 3.3721e-06 - mape: 6.4713 - val_loss: 8.9793e-06 - val_mape: 8.9874
Epoch 15/50
40/40 [==============================] - 0s 7ms/step - loss: 3.6199e-06 - mape: 6.5232 - val_loss: 6.9976e-06 - val_mape: 9.1802
Epoch 16/50
31/40 [======================>.......] - ETA: 0s - loss: 3.1092e-06 - mape: 6.2358
40/40 [==============================] - 1s 30ms/step - loss: 3.5623e-06 - mape: 6.3446 - val_loss: 7.9497e-07 - val_mape: 5.7904
Epoch 17/50
40/40 [==============================] - 1s 37ms/step - loss: 2.7397e-06 - mape: 5.8943 - val_loss: 6.2938e-07 - val_mape: 5.4162
Epoch 18/50
30/40 [=====================>........] - ETA: 0s - loss: 3.8846e-06 - mape: 5.9952
wandb: Adding directory to artifact (C:\Users\PAVILION 15-DW001LA\Documents\Tesis\Códigos\RNAs\Red_Convolucional\wandb\run-20230406_135047-qe7winpr\files\model-best)... Done. 0.0s
40/40 [==============================] - 1s 29ms/step - loss: 3.6717e-06 - mape: 6.1597 - val_loss: 5.7128e-07 - val_mape: 5.4283
Epoch 19/50
40/40 [==============================] - 0s 9ms/step - loss: 3.0937e-06 - mape: 5.8886 - val_loss: 6.2564e-07 - val_mape: 5.9178
Epoch 20/50
40/40 [==============================] - 0s 7ms/step - loss: 3.0448e-06 - mape: 5.8852 - val_loss: 9.7395e-07 - val_mape: 6.8087
Epoch 21/50
40/40 [==============================] - 0s 7ms/step - loss: 3.3339e-06 - mape: 5.9954 - val_loss: 1.1901e-05 - val_mape: 9.7663
Epoch 22/50
40/40 [==============================] - 0s 7ms/step - loss: 3.0144e-06 - mape: 5.5440 - val_loss: 1.6524e-06 - val_mape: 6.3080
Epoch 23/50
40/40 [==============================] - 0s 7ms/step - loss: 3.2624e-06 - mape: 5.8142 - val_loss: 3.4711e-06 - val_mape: 7.2895
Epoch 24/50
40/40 [==============================] - 0s 7ms/step - loss: 3.1584e-06 - mape: 5.5126 - val_loss: 6.5006e-06 - val_mape: 7.6461
Epoch 25/50
40/40 [==============================] - 0s 7ms/step - loss: 3.2418e-06 - mape: 5.5669 - val_loss: 1.8175e-06 - val_mape: 5.2071
Epoch 26/50
40/40 [==============================] - 0s 7ms/step - loss: 2.6509e-06 - mape: 4.8729 - val_loss: 1.6215e-05 - val_mape: 10.3932
Epoch 27/50
40/40 [==============================] - 0s 7ms/step - loss: 3.1367e-06 - mape: 5.1280 - val_loss: 1.3413e-06 - val_mape: 5.4867
Epoch 28/50
40/40 [==============================] - 0s 8ms/step - loss: 3.2536e-06 - mape: 5.2985 - val_loss: 2.7347e-06 - val_mape: 6.7965
Epoch 29/50
40/40 [==============================] - 0s 7ms/step - loss: 2.9415e-06 - mape: 5.2791 - val_loss: 9.2833e-06 - val_mape: 7.6266
Epoch 30/50
40/40 [==============================] - 0s 7ms/step - loss: 3.0596e-06 - mape: 5.0402 - val_loss: 1.0165e-06 - val_mape: 4.9160
Epoch 31/50
29/40 [====================>.........] - ETA: 0s - loss: 2.6059e-06 - mape: 5.0830
40/40 [==============================] - 1s 30ms/step - loss: 2.8332e-06 - mape: 5.1025 - val_loss: 5.6735e-07 - val_mape: 5.4082
Epoch 32/50
40/40 [==============================] - 0s 7ms/step - loss: 2.8113e-06 - mape: 4.9638 - val_loss: 8.3772e-07 - val_mape: 6.0923
Epoch 33/50
40/40 [==============================] - 0s 7ms/step - loss: 3.1515e-06 - mape: 4.8617 - val_loss: 8.1134e-06 - val_mape: 7.4548
Epoch 34/50
31/40 [======================>.......] - ETA: 0s - loss: 2.6226e-06 - mape: 4.9565
40/40 [==============================] - 2s 42ms/step - loss: 2.6409e-06 - mape: 4.7425 - val_loss: 4.9634e-07 - val_mape: 4.0244
Epoch 35/50
40/40 [==============================] - 0s 9ms/step - loss: 2.7729e-06 - mape: 4.7492 - val_loss: 1.8056e-06 - val_mape: 6.0339
Epoch 36/50
40/40 [==============================] - 0s 7ms/step - loss: 2.7843e-06 - mape: 4.7335 - val_loss: 1.5388e-06 - val_mape: 4.8751
Epoch 37/50
40/40 [==============================] - 0s 7ms/step - loss: 3.0001e-06 - mape: 4.6410 - val_loss: 2.1871e-05 - val_mape: 10.9438
Epoch 38/50
40/40 [==============================] - 0s 7ms/step - loss: 2.6312e-06 - mape: 4.1803 - val_loss: 7.4028e-06 - val_mape: 6.2645
Epoch 39/50
40/40 [==============================] - 0s 7ms/step - loss: 3.1513e-06 - mape: 4.3637 - val_loss: 7.7975e-07 - val_mape: 4.7430
Epoch 40/50
40/40 [==============================] - 0s 7ms/step - loss: 2.9145e-06 - mape: 4.4356 - val_loss: 5.4335e-07 - val_mape: 5.0494
Epoch 41/50
40/40 [==============================] - 0s 7ms/step - loss: 2.8738e-06 - mape: 4.6796 - val_loss: 1.2429e-06 - val_mape: 4.8185
Epoch 42/50
40/40 [==============================] - 0s 7ms/step - loss: 2.9270e-06 - mape: 4.7982 - val_loss: 2.3813e-06 - val_mape: 6.3208
Epoch 43/50
40/40 [==============================] - 0s 7ms/step - loss: 2.6164e-06 - mape: 4.2251 - val_loss: 6.9729e-06 - val_mape: 6.9038
Epoch 44/50
40/40 [==============================] - 0s 7ms/step - loss: 2.9692e-06 - mape: 4.5448 - val_loss: 4.1712e-06 - val_mape: 6.3583
Epoch 45/50
40/40 [==============================] - 0s 7ms/step - loss: 2.4474e-06 - mape: 4.2820 - val_loss: 1.4796e-05 - val_mape: 8.2449
Epoch 46/50
40/40 [==============================] - 0s 7ms/step - loss: 2.7470e-06 - mape: 4.6644 - val_loss: 1.0703e-06 - val_mape: 4.7352
Epoch 47/50
40/40 [==============================] - 0s 8ms/step - loss: 2.7841e-06 - mape: 4.3459 - val_loss: 6.3137e-06 - val_mape: 6.3786
Epoch 48/50
40/40 [==============================] - 1s 38ms/step - loss: 2.8779e-06 - mape: 4.3457 - val_loss: 3.0797e-07 - val_mape: 3.8787
Epoch 49/50
40/40 [==============================] - 0s 8ms/step - loss: 2.6681e-06 - mape: 4.5689 - val_loss: 4.1181e-06 - val_mape: 6.0279
Epoch 50/50
40/40 [==============================] - 0s 7ms/step - loss: 2.7539e-06 - mape: 4.1219 - val_loss: 6.0466e-06 - val_mape: 5.9387
7/7 [==============================] - 0s 2ms/step - loss: 6.0466e-06 - mape: 5.9387
[6.0465908973128535e-06, 5.938657283782959]
Lo que obtuvo la red fue:
[0.06983373 0.03643984 0.03835866 0.07553446]
El resultado correcto:
[0.0689  0.03495 0.03595 0.0699 ]