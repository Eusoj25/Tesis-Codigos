wandb: WARNING The save_model argument by default saves the model in the HDF5 format that cannot save custom objects like subclassed models and custom layers. This behavior will be deprecated in a future release in favor of the SavedModel format. Meanwhile, the HDF5 model is saved as W&B files and the SavedModel as W&B Artifacts.
WARNING:tensorflow:Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.0032s vs `on_train_batch_end` time: 0.0042s). Check your callbacks.
Epoch 1/30
34/40 [========================>.....] - ETA: 0s - loss: 0.1008 - mape: 1445.2877
40/40 [==============================] - 2s 37ms/step - loss: 0.0916 - mape: 1352.6073 - val_loss: 0.0233 - val_mape: 660.8066
Epoch 2/30
35/40 [=========================>....] - ETA: 0s - loss: 0.0105 - mape: 431.5445
40/40 [==============================] - 1s 30ms/step - loss: 0.0096 - mape: 404.3582 - val_loss: 0.0021 - val_mape: 195.8685
Epoch 3/30
36/40 [==========================>...] - ETA: 0s - loss: 0.0012 - mape: 135.0793
wandb: Adding directory to artifact (C:\Users\PAVILION 15-DW001LA\Documents\Tesis\CÃ³digos\RNAs\Red_Convolucional\wandb\run-20230405_225156-ci8no54m\files\model-best)... Done. 0.0s
40/40 [==============================] - 1s 27ms/step - loss: 0.0012 - mape: 131.5527 - val_loss: 6.8769e-04 - val_mape: 87.3424
Epoch 4/30
36/40 [==========================>...] - ETA: 0s - loss: 5.0214e-04 - mape: 70.7891
40/40 [==============================] - 1s 28ms/step - loss: 4.9686e-04 - mape: 70.0259 - val_loss: 3.5334e-04 - val_mape: 61.0422
Epoch 5/30
40/40 [==============================] - 1s 34ms/step - loss: 2.6046e-04 - mape: 48.9211 - val_loss: 1.7242e-04 - val_mape: 41.5309
Epoch 6/30
32/40 [=======================>......] - ETA: 0s - loss: 1.4541e-04 - mape: 36.1078
40/40 [==============================] - 1s 38ms/step - loss: 1.3404e-04 - mape: 34.5882 - val_loss: 9.0185e-05 - val_mape: 29.3332
Epoch 7/30
38/40 [===========================>..] - ETA: 0s - loss: 6.9790e-05 - mape: 27.0993
40/40 [==============================] - 1s 30ms/step - loss: 6.8856e-05 - mape: 26.8819 - val_loss: 5.9859e-05 - val_mape: 23.7931
Epoch 8/30
34/40 [========================>.....] - ETA: 0s - loss: 3.8853e-05 - mape: 21.5955
40/40 [==============================] - 1s 28ms/step - loss: 3.6826e-05 - mape: 21.7779 - val_loss: 2.2775e-05 - val_mape: 20.0858
Epoch 9/30
36/40 [==========================>...] - ETA: 0s - loss: 2.1971e-05 - mape: 18.2801
40/40 [==============================] - 1s 27ms/step - loss: 2.1777e-05 - mape: 17.8159 - val_loss: 1.5968e-05 - val_mape: 15.7933
Epoch 10/30
35/40 [=========================>....] - ETA: 0s - loss: 1.2352e-05 - mape: 13.2016
40/40 [==============================] - 1s 28ms/step - loss: 1.1669e-05 - mape: 13.1938 - val_loss: 9.5972e-06 - val_mape: 13.6067
Epoch 11/30
34/40 [========================>.....] - ETA: 0s - loss: 7.9999e-06 - mape: 11.0192
40/40 [==============================] - 1s 28ms/step - loss: 8.1873e-06 - mape: 11.0492 - val_loss: 4.7072e-06 - val_mape: 11.1601
Epoch 12/30
40/40 [==============================] - 0s 7ms/step - loss: 5.3363e-06 - mape: 8.9653 - val_loss: 7.6137e-06 - val_mape: 10.2599
Epoch 13/30
34/40 [========================>.....] - ETA: 0s - loss: 5.2036e-06 - mape: 8.1520
40/40 [==============================] - 1s 32ms/step - loss: 5.3849e-06 - mape: 8.0661 - val_loss: 1.8938e-06 - val_mape: 7.4328
Epoch 14/30
40/40 [==============================] - 0s 6ms/step - loss: 4.0722e-06 - mape: 6.9631 - val_loss: 5.0153e-06 - val_mape: 7.8060
Epoch 15/30
40/40 [==============================] - 0s 6ms/step - loss: 3.8653e-06 - mape: 6.0047 - val_loss: 6.6031e-06 - val_mape: 8.1642
Epoch 16/30
40/40 [==============================] - 0s 7ms/step - loss: 4.3229e-06 - mape: 5.9545 - val_loss: 3.5552e-06 - val_mape: 7.5197
Epoch 17/30
40/40 [==============================] - ETA: 0s - loss: 3.5842e-06 - mape: 5.4912
40/40 [==============================] - 1s 32ms/step - loss: 3.5842e-06 - mape: 5.4912 - val_loss: 6.4468e-07 - val_mape: 5.0640
Epoch 18/30
26/40 [==================>...........] - ETA: 0s - loss: 3.8063e-06 - mape: 5.3051
40/40 [==============================] - 1s 35ms/step - loss: 4.2833e-06 - mape: 5.7923 - val_loss: 5.4456e-07 - val_mape: 4.8646
Epoch 19/30
40/40 [==============================] - 0s 6ms/step - loss: 3.9371e-06 - mape: 5.3606 - val_loss: 2.5638e-06 - val_mape: 5.8652
Epoch 20/30
40/40 [==============================] - 0s 6ms/step - loss: 3.0126e-06 - mape: 4.8853 - val_loss: 1.2549e-06 - val_mape: 5.1411
Epoch 21/30
40/40 [==============================] - 0s 6ms/step - loss: 3.9059e-06 - mape: 5.2554 - val_loss: 3.6378e-06 - val_mape: 6.1510
Epoch 22/30
40/40 [==============================] - 0s 6ms/step - loss: 4.2721e-06 - mape: 5.3551 - val_loss: 1.4896e-06 - val_mape: 5.3985
Epoch 23/30
40/40 [==============================] - 0s 6ms/step - loss: 3.3691e-06 - mape: 4.7943 - val_loss: 1.2837e-05 - val_mape: 9.2256
Epoch 24/30
40/40 [==============================] - 0s 6ms/step - loss: 3.3582e-06 - mape: 4.6620 - val_loss: 2.1552e-06 - val_mape: 5.0972
Epoch 25/30
40/40 [==============================] - 0s 6ms/step - loss: 3.3156e-06 - mape: 4.5103 - val_loss: 2.8187e-06 - val_mape: 5.4163
Epoch 26/30
32/40 [=======================>......] - ETA: 0s - loss: 4.2551e-06 - mape: 5.1285
40/40 [==============================] - 1s 27ms/step - loss: 3.6821e-06 - mape: 4.8557 - val_loss: 3.5893e-07 - val_mape: 3.7675
Epoch 27/30
40/40 [==============================] - 0s 6ms/step - loss: 4.1771e-06 - mape: 4.4260 - val_loss: 1.2556e-06 - val_mape: 4.5782
Epoch 28/30
40/40 [==============================] - 0s 6ms/step - loss: 2.8777e-06 - mape: 4.0350 - val_loss: 2.7409e-06 - val_mape: 5.2868
Epoch 29/30
40/40 [==============================] - 0s 6ms/step - loss: 3.5325e-06 - mape: 4.4770 - val_loss: 4.3261e-07 - val_mape: 3.6292
Epoch 30/30
36/40 [==========================>...] - ETA: 0s - loss: 4.3408e-06 - mape: 4.4745
40/40 [==============================] - 1s 28ms/step - loss: 4.0063e-06 - mape: 4.2549 - val_loss: 3.0722e-07 - val_mape: 3.3244
7/7 [==============================] - 0s 2ms/step - loss: 3.0722e-07 - mape: 3.3244
[3.0722085853085446e-07, 3.3244242668151855]
Lo que obtuvo la red fue:
[0.06923622 0.03506461 0.03601491 0.07037279]
El resultado correcto:
[0.0689  0.03495 0.03595 0.0699 ]