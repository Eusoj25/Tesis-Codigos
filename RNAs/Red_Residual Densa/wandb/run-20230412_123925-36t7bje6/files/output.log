wandb: WARNING The save_model argument by default saves the model in the HDF5 format that cannot save custom objects like subclassed models and custom layers. This behavior will be deprecated in a future release in favor of the SavedModel format. Meanwhile, the HDF5 model is saved as W&B files and the SavedModel as W&B Artifacts.
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\engine\functional.py:1410: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  layer_config = serialize_layer_fn(layer)
Epoch 1/50

40/40 [==============================] - ETA: 0s - loss: 0.0517 - mape: 843.3182
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\engine\functional.py:1410: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  layer_config = serialize_layer_fn(layer)
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\saving\saved_model\layer_serialization.py:112: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  return generic_utils.serialize_keras_object(obj)
40/40 [==============================] - 6s 136ms/step - loss: 0.0517 - mape: 843.3182 - val_loss: 0.0035 - val_mape: 215.5696
Epoch 2/50
40/40 [==============================] - ETA: 0s - loss: 0.0014 - mape: 119.7128
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\engine\functional.py:1410: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  layer_config = serialize_layer_fn(layer)
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\saving\saved_model\layer_serialization.py:112: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  return generic_utils.serialize_keras_object(obj)
40/40 [==============================] - 14s 348ms/step - loss: 0.0014 - mape: 119.7128 - val_loss: 4.0180e-04 - val_mape: 58.2910
Epoch 3/50
39/40 [============================>.] - ETA: 0s - loss: 2.2797e-04 - mape: 43.6051
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\engine\functional.py:1410: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  layer_config = serialize_layer_fn(layer)
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\saving\saved_model\layer_serialization.py:112: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  return generic_utils.serialize_keras_object(obj)
40/40 [==============================] - 7s 183ms/step - loss: 2.2775e-04 - mape: 43.5961 - val_loss: 1.9253e-04 - val_mape: 38.3687
Epoch 4/50
40/40 [==============================] - ETA: 0s - loss: 8.0380e-05 - mape: 25.7445
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\engine\functional.py:1410: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  layer_config = serialize_layer_fn(layer)
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\saving\saved_model\layer_serialization.py:112: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  return generic_utils.serialize_keras_object(obj)
40/40 [==============================] - 7s 174ms/step - loss: 8.0380e-05 - mape: 25.7445 - val_loss: 1.7403e-05 - val_mape: 15.8477
Epoch 5/50
40/40 [==============================] - 3s 86ms/step - loss: 5.0170e-05 - mape: 19.2564 - val_loss: 1.9407e-05 - val_mape: 13.8627
Epoch 6/50
40/40 [==============================] - ETA: 0s - loss: 4.5827e-05 - mape: 17.6499
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\engine\functional.py:1410: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  layer_config = serialize_layer_fn(layer)
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\saving\saved_model\layer_serialization.py:112: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  return generic_utils.serialize_keras_object(obj)
wandb: Adding directory to artifact (C:\Users\PAVILION 15-DW001LA\Documents\Tesis\CÃ³digos\RNAs\Red_Residual Densa\wandb\run-20230412_123925-36t7bje6\files\model-best)... Done. 0.1s
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\engine\functional.py:1410: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  layer_config = serialize_layer_fn(layer)
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\saving\saved_model\layer_serialization.py:112: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  return generic_utils.serialize_keras_object(obj)
40/40 [==============================] - 6s 158ms/step - loss: 4.5827e-05 - mape: 17.6499 - val_loss: 1.4026e-05 - val_mape: 11.4702
Epoch 7/50
40/40 [==============================] - ETA: 0s - loss: 3.7090e-05 - mape: 15.9031
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\engine\functional.py:1410: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  layer_config = serialize_layer_fn(layer)
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\saving\saved_model\layer_serialization.py:112: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  return generic_utils.serialize_keras_object(obj)
40/40 [==============================] - 6s 150ms/step - loss: 3.7090e-05 - mape: 15.9031 - val_loss: 4.5727e-06 - val_mape: 9.6118
Epoch 8/50
40/40 [==============================] - 3s 83ms/step - loss: 3.1012e-05 - mape: 14.5334 - val_loss: 4.6929e-05 - val_mape: 15.7969
Epoch 9/50
40/40 [==============================] - 3s 82ms/step - loss: 3.2954e-05 - mape: 14.3879 - val_loss: 1.1591e-05 - val_mape: 10.5015
Epoch 10/50
40/40 [==============================] - 3s 83ms/step - loss: 2.9787e-05 - mape: 13.6445 - val_loss: 5.0238e-05 - val_mape: 15.3039
Epoch 11/50
40/40 [==============================] - 5s 122ms/step - loss: 2.5058e-05 - mape: 12.6930 - val_loss: 3.2509e-06 - val_mape: 6.5416
Epoch 12/50
40/40 [==============================] - 3s 82ms/step - loss: 2.3541e-05 - mape: 12.4815 - val_loss: 1.8338e-05 - val_mape: 12.1489
Epoch 13/50
40/40 [==============================] - 3s 82ms/step - loss: 2.2723e-05 - mape: 12.0689 - val_loss: 6.9926e-05 - val_mape: 17.2396
Epoch 14/50
10/40 [======>.......................] - ETA: 1s - loss: 2.6654e-05 - mape: 10.3637
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\engine\functional.py:1410: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  layer_config = serialize_layer_fn(layer)
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\saving\saved_model\layer_serialization.py:112: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  return generic_utils.serialize_keras_object(obj)

40/40 [==============================] - 3s 84ms/step - loss: 2.0985e-05 - mape: 11.3751 - val_loss: 3.0343e-05 - val_mape: 12.3944
Epoch 15/50
40/40 [==============================] - 5s 130ms/step - loss: 1.9046e-05 - mape: 11.0563 - val_loss: 6.8295e-07 - val_mape: 5.3938
Epoch 16/50
40/40 [==============================] - 3s 88ms/step - loss: 1.8612e-05 - mape: 10.8244 - val_loss: 2.1716e-05 - val_mape: 11.0750
Epoch 17/50
40/40 [==============================] - 3s 80ms/step - loss: 1.6401e-05 - mape: 10.2477 - val_loss: 9.5263e-06 - val_mape: 8.6789
Epoch 18/50
40/40 [==============================] - 3s 84ms/step - loss: 1.5878e-05 - mape: 9.9657 - val_loss: 4.5779e-06 - val_mape: 7.1245
Epoch 19/50
40/40 [==============================] - 3s 84ms/step - loss: 1.4205e-05 - mape: 9.6836 - val_loss: 6.1065e-05 - val_mape: 17.8491
Epoch 20/50
40/40 [==============================] - 3s 81ms/step - loss: 1.4889e-05 - mape: 9.4882 - val_loss: 6.5408e-06 - val_mape: 7.2787
Epoch 21/50
40/40 [==============================] - 3s 81ms/step - loss: 1.3663e-05 - mape: 9.4877 - val_loss: 1.4153e-05 - val_mape: 11.1617
Epoch 22/50
40/40 [==============================] - 3s 78ms/step - loss: 1.1971e-05 - mape: 8.8812 - val_loss: 5.4476e-06 - val_mape: 7.4866
Epoch 23/50
40/40 [==============================] - 3s 83ms/step - loss: 1.3019e-05 - mape: 8.8695 - val_loss: 2.1902e-06 - val_mape: 5.8491
Epoch 24/50
40/40 [==============================] - 3s 82ms/step - loss: 1.2073e-05 - mape: 8.9518 - val_loss: 2.6322e-05 - val_mape: 13.1351
Epoch 25/50
40/40 [==============================] - 3s 84ms/step - loss: 1.0065e-05 - mape: 8.1163 - val_loss: 3.0813e-05 - val_mape: 12.3804
Epoch 26/50
39/40 [============================>.] - ETA: 0s - loss: 1.2515e-05 - mape: 8.4132
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\engine\functional.py:1410: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  layer_config = serialize_layer_fn(layer)
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\saving\saved_model\layer_serialization.py:112: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  return generic_utils.serialize_keras_object(obj)
40/40 [==============================] - 5s 134ms/step - loss: 1.2471e-05 - mape: 8.3939 - val_loss: 6.0013e-07 - val_mape: 4.9226
Epoch 27/50
40/40 [==============================] - 3s 84ms/step - loss: 9.2120e-06 - mape: 7.8256 - val_loss: 9.3390e-07 - val_mape: 5.6205
Epoch 28/50
40/40 [==============================] - 3s 84ms/step - loss: 9.9984e-06 - mape: 7.7106 - val_loss: 2.7241e-05 - val_mape: 13.1576
Epoch 29/50
40/40 [==============================] - 3s 82ms/step - loss: 1.0317e-05 - mape: 7.7688 - val_loss: 2.9075e-06 - val_mape: 6.5714
Epoch 30/50
40/40 [==============================] - ETA: 0s - loss: 9.2763e-06 - mape: 7.5656
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\engine\functional.py:1410: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  layer_config = serialize_layer_fn(layer)
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\saving\saved_model\layer_serialization.py:112: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  return generic_utils.serialize_keras_object(obj)
40/40 [==============================] - 5s 129ms/step - loss: 9.2763e-06 - mape: 7.5656 - val_loss: 4.2893e-07 - val_mape: 4.4953
Epoch 31/50
40/40 [==============================] - 3s 83ms/step - loss: 7.4481e-06 - mape: 7.0977 - val_loss: 2.5363e-06 - val_mape: 5.1220
Epoch 32/50
40/40 [==============================] - 3s 84ms/step - loss: 9.0637e-06 - mape: 7.5771 - val_loss: 7.0972e-06 - val_mape: 7.3856
Epoch 33/50
40/40 [==============================] - 3s 83ms/step - loss: 9.4503e-06 - mape: 7.4029 - val_loss: 3.1594e-05 - val_mape: 13.7748
Epoch 34/50
40/40 [==============================] - 3s 83ms/step - loss: 6.2135e-06 - mape: 6.4782 - val_loss: 1.0518e-05 - val_mape: 9.9714
Epoch 35/50
40/40 [==============================] - 3s 83ms/step - loss: 8.2261e-06 - mape: 7.2650 - val_loss: 2.2373e-06 - val_mape: 5.7033
Epoch 36/50
40/40 [==============================] - 3s 85ms/step - loss: 7.5293e-06 - mape: 6.7912 - val_loss: 4.0702e-06 - val_mape: 6.6349
Epoch 37/50
40/40 [==============================] - 3s 83ms/step - loss: 7.9559e-06 - mape: 6.8883 - val_loss: 3.7292e-06 - val_mape: 7.0859
Epoch 38/50
40/40 [==============================] - 3s 85ms/step - loss: 5.9375e-06 - mape: 6.3567 - val_loss: 1.6786e-06 - val_mape: 5.9092
Epoch 39/50
40/40 [==============================] - 3s 83ms/step - loss: 7.0507e-06 - mape: 6.7287 - val_loss: 2.1534e-05 - val_mape: 11.9927
Epoch 40/50
40/40 [==============================] - 3s 84ms/step - loss: 5.6314e-06 - mape: 5.9476 - val_loss: 8.5497e-07 - val_mape: 3.8575
Epoch 41/50
40/40 [==============================] - 3s 82ms/step - loss: 6.6692e-06 - mape: 6.6609 - val_loss: 7.8692e-07 - val_mape: 4.1025
Epoch 42/50
40/40 [==============================] - 3s 82ms/step - loss: 6.3730e-06 - mape: 6.3895 - val_loss: 4.5337e-07 - val_mape: 4.1367
Epoch 43/50
40/40 [==============================] - 3s 82ms/step - loss: 5.1996e-06 - mape: 5.5518 - val_loss: 3.4485e-06 - val_mape: 5.9604
Epoch 44/50
40/40 [==============================] - 3s 82ms/step - loss: 7.2107e-06 - mape: 6.3873 - val_loss: 5.2183e-07 - val_mape: 3.7853
Epoch 45/50
40/40 [==============================] - 3s 82ms/step - loss: 5.6549e-06 - mape: 6.0413 - val_loss: 2.1337e-05 - val_mape: 10.6056
Epoch 46/50
40/40 [==============================] - 3s 82ms/step - loss: 6.2709e-06 - mape: 6.1483 - val_loss: 1.2664e-05 - val_mape: 9.5535
Epoch 47/50

40/40 [==============================] - 3s 81ms/step - loss: 5.4215e-06 - mape: 5.8396 - val_loss: 3.5683e-06 - val_mape: 5.5347
Epoch 48/50

40/40 [==============================] - ETA: 0s - loss: 5.3033e-06 - mape: 5.8436
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\engine\functional.py:1410: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  layer_config = serialize_layer_fn(layer)
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\saving\saved_model\layer_serialization.py:112: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  return generic_utils.serialize_keras_object(obj)
40/40 [==============================] - 5s 118ms/step - loss: 5.3033e-06 - mape: 5.8436 - val_loss: 2.4197e-07 - val_mape: 3.2022
Epoch 49/50
40/40 [==============================] - 3s 84ms/step - loss: 5.5056e-06 - mape: 5.5526 - val_loss: 4.1440e-07 - val_mape: 3.4297
Epoch 50/50
40/40 [==============================] - 3s 86ms/step - loss: 4.0548e-06 - mape: 5.0539 - val_loss: 2.0698e-06 - val_mape: 4.8679
7/7 [==============================] - 0s 7ms/step - loss: 2.0698e-06 - mape: 4.8679
[2.0698139451269526e-06, 4.867879867553711]
Lo que obtuvo la red fue:
[0.03085965 0.01671305 0.01731014 0.03398371]
El resultado correcto:
[0.0315  0.01625 0.01725 0.0325 ]