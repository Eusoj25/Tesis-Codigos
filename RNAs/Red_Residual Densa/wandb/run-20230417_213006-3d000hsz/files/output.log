wandb: WARNING The save_model argument by default saves the model in the HDF5 format that cannot save custom objects like subclassed models and custom layers. This behavior will be deprecated in a future release in favor of the SavedModel format. Meanwhile, the HDF5 model is saved as W&B files and the SavedModel as W&B Artifacts.
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\engine\functional.py:1410: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  layer_config = serialize_layer_fn(layer)
Epoch 1/50
40/40 [==============================] - ETA: 0s - loss: 0.0700 - mape: 1106.9657
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\engine\functional.py:1410: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  layer_config = serialize_layer_fn(layer)
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\saving\saved_model\layer_serialization.py:112: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  return generic_utils.serialize_keras_object(obj)
wandb: Adding directory to artifact (C:\Users\PAVILION 15-DW001LA\Documents\Tesis\Códigos\RNAs\Red_Residual Densa\wandb\run-20230417_213006-3d000hsz\files\model-best)... Done. 0.1s
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\engine\functional.py:1410: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  layer_config = serialize_layer_fn(layer)
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\saving\saved_model\layer_serialization.py:112: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  return generic_utils.serialize_keras_object(obj)
40/40 [==============================] - 7s 143ms/step - loss: 0.0700 - mape: 1106.9657 - val_loss: 0.1609 - val_mape: 2146.2195
Epoch 2/50
39/40 [============================>.] - ETA: 0s - loss: 0.0255 - mape: 631.2355
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\engine\functional.py:1410: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  layer_config = serialize_layer_fn(layer)
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\saving\saved_model\layer_serialization.py:112: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  return generic_utils.serialize_keras_object(obj)
40/40 [==============================] - 7s 167ms/step - loss: 0.0255 - mape: 631.3306 - val_loss: 0.1200 - val_mape: 1868.7623
Epoch 3/50
39/40 [============================>.] - ETA: 0s - loss: 0.0104 - mape: 395.7723
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\engine\functional.py:1410: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  layer_config = serialize_layer_fn(layer)
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\saving\saved_model\layer_serialization.py:112: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  return generic_utils.serialize_keras_object(obj)
40/40 [==============================] - 5s 132ms/step - loss: 0.0105 - mape: 395.8911 - val_loss: 0.0704 - val_mape: 1336.5861
Epoch 4/50
39/40 [============================>.] - ETA: 0s - loss: 0.0056 - mape: 263.0513
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\engine\functional.py:1410: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  layer_config = serialize_layer_fn(layer)
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\saving\saved_model\layer_serialization.py:112: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  return generic_utils.serialize_keras_object(obj)
40/40 [==============================] - 5s 132ms/step - loss: 0.0056 - mape: 264.1263 - val_loss: 0.0346 - val_mape: 899.4265
Epoch 5/50
38/40 [===========================>..] - ETA: 0s - loss: 0.0026 - mape: 169.7086
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\engine\functional.py:1410: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  layer_config = serialize_layer_fn(layer)
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\saving\saved_model\layer_serialization.py:112: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  return generic_utils.serialize_keras_object(obj)
40/40 [==============================] - 6s 152ms/step - loss: 0.0026 - mape: 166.8109 - val_loss: 0.0162 - val_mape: 625.5109
Epoch 6/50
39/40 [============================>.] - ETA: 0s - loss: 0.0014 - mape: 129.1000
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\engine\functional.py:1410: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  layer_config = serialize_layer_fn(layer)
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\saving\saved_model\layer_serialization.py:112: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  return generic_utils.serialize_keras_object(obj)
40/40 [==============================] - 5s 133ms/step - loss: 0.0014 - mape: 128.7617 - val_loss: 0.0066 - val_mape: 390.4314
Epoch 7/50
40/40 [==============================] - ETA: 0s - loss: 8.2076e-04 - mape: 80.7705
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\engine\functional.py:1410: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  layer_config = serialize_layer_fn(layer)
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\saving\saved_model\layer_serialization.py:112: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  return generic_utils.serialize_keras_object(obj)
40/40 [==============================] - 5s 125ms/step - loss: 8.2076e-04 - mape: 80.7705 - val_loss: 0.0030 - val_mape: 246.0199
Epoch 8/50
39/40 [============================>.] - ETA: 0s - loss: 5.1867e-04 - mape: 68.5557
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\engine\functional.py:1410: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  layer_config = serialize_layer_fn(layer)
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\saving\saved_model\layer_serialization.py:112: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  return generic_utils.serialize_keras_object(obj)
40/40 [==============================] - 7s 171ms/step - loss: 5.3299e-04 - mape: 68.5768 - val_loss: 7.9328e-04 - val_mape: 114.6887
Epoch 9/50
40/40 [==============================] - 2s 59ms/step - loss: 5.4197e-04 - mape: 60.8548 - val_loss: 0.0014 - val_mape: 119.9676
Epoch 10/50
40/40 [==============================] - 5s 133ms/step - loss: 4.9923e-04 - mape: 58.0530 - val_loss: 3.4196e-04 - val_mape: 63.7319
Epoch 11/50
40/40 [==============================] - 2s 60ms/step - loss: 4.3387e-04 - mape: 52.5308 - val_loss: 0.0014 - val_mape: 96.7120
Epoch 12/50
39/40 [============================>.] - ETA: 0s - loss: 4.0704e-04 - mape: 53.8356
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\engine\functional.py:1410: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  layer_config = serialize_layer_fn(layer)
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\saving\saved_model\layer_serialization.py:112: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  return generic_utils.serialize_keras_object(obj)
wandb: Adding directory to artifact (C:\Users\PAVILION 15-DW001LA\Documents\Tesis\Códigos\RNAs\Red_Residual Densa\wandb\run-20230417_213006-3d000hsz\files\model-best)... Done. 0.0s
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\engine\functional.py:1410: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  layer_config = serialize_layer_fn(layer)
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\saving\saved_model\layer_serialization.py:112: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  return generic_utils.serialize_keras_object(obj)
40/40 [==============================] - 5s 126ms/step - loss: 4.1580e-04 - mape: 53.9499 - val_loss: 3.2157e-04 - val_mape: 40.7356
Epoch 13/50
40/40 [==============================] - 2s 59ms/step - loss: 3.8307e-04 - mape: 51.4850 - val_loss: 3.4995e-04 - val_mape: 39.3722
Epoch 14/50
40/40 [==============================] - 2s 59ms/step - loss: 4.3828e-04 - mape: 51.6259 - val_loss: 4.1361e-04 - val_mape: 43.9591
Epoch 15/50
40/40 [==============================] - 2s 59ms/step - loss: 3.9298e-04 - mape: 49.9682 - val_loss: 3.4672e-04 - val_mape: 37.5654
Epoch 16/50
39/40 [============================>.] - ETA: 0s - loss: 3.3764e-04 - mape: 46.7503
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\engine\functional.py:1410: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  layer_config = serialize_layer_fn(layer)
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\saving\saved_model\layer_serialization.py:112: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  return generic_utils.serialize_keras_object(obj)
40/40 [==============================] - 10s 260ms/step - loss: 3.4187e-04 - mape: 46.9726 - val_loss: 3.0774e-04 - val_mape: 37.4829
Epoch 17/50
40/40 [==============================] - 2s 60ms/step - loss: 3.3678e-04 - mape: 46.6871 - val_loss: 4.1691e-04 - val_mape: 41.1510
Epoch 18/50
40/40 [==============================] - 2s 57ms/step - loss: 3.3917e-04 - mape: 49.4593 - val_loss: 4.3421e-04 - val_mape: 41.0433
Epoch 19/50
40/40 [==============================] - 2s 56ms/step - loss: 3.4192e-04 - mape: 47.2757 - val_loss: 3.5727e-04 - val_mape: 40.8641
Epoch 20/50
40/40 [==============================] - 2s 57ms/step - loss: 3.5662e-04 - mape: 55.2967 - val_loss: 3.2158e-04 - val_mape: 39.5378
Epoch 21/50
40/40 [==============================] - 2s 58ms/step - loss: 3.0212e-04 - mape: 45.5685 - val_loss: 3.0775e-04 - val_mape: 40.2455
Epoch 22/50
40/40 [==============================] - 6s 144ms/step - loss: 2.9825e-04 - mape: 46.1976 - val_loss: 3.0675e-04 - val_mape: 39.2012
Epoch 23/50
39/40 [============================>.] - ETA: 0s - loss: 2.7846e-04 - mape: 45.8776
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\engine\functional.py:1410: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  layer_config = serialize_layer_fn(layer)
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\saving\saved_model\layer_serialization.py:112: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  return generic_utils.serialize_keras_object(obj)
wandb: Adding directory to artifact (C:\Users\PAVILION 15-DW001LA\Documents\Tesis\Códigos\RNAs\Red_Residual Densa\wandb\run-20230417_213006-3d000hsz\files\model-best)... Done. 0.1s
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\engine\functional.py:1410: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  layer_config = serialize_layer_fn(layer)
C:\Users\PAVILION 15-DW001LA\miniconda3\lib\site-packages\keras\saving\saved_model\layer_serialization.py:112: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  return generic_utils.serialize_keras_object(obj)
40/40 [==============================] - 5s 126ms/step - loss: 2.9330e-04 - mape: 46.1637 - val_loss: 2.7325e-04 - val_mape: 38.8929
Epoch 24/50
40/40 [==============================] - 6s 146ms/step - loss: 2.4717e-04 - mape: 42.9811 - val_loss: 2.4380e-04 - val_mape: 39.8682
Epoch 25/50
40/40 [==============================] - 2s 58ms/step - loss: 2.7868e-04 - mape: 43.9536 - val_loss: 2.7268e-04 - val_mape: 40.0998
Epoch 26/50
40/40 [==============================] - 2s 58ms/step - loss: 2.6185e-04 - mape: 45.7508 - val_loss: 3.2343e-04 - val_mape: 40.6880
Epoch 27/50
40/40 [==============================] - 2s 58ms/step - loss: 2.3339e-04 - mape: 43.0428 - val_loss: 2.9515e-04 - val_mape: 39.2398
Epoch 28/50
40/40 [==============================] - 2s 58ms/step - loss: 2.5996e-04 - mape: 43.2275 - val_loss: 2.7526e-04 - val_mape: 38.4878
Epoch 29/50
40/40 [==============================] - 2s 58ms/step - loss: 2.2356e-04 - mape: 42.1117 - val_loss: 2.7985e-04 - val_mape: 37.7238
Epoch 30/50
40/40 [==============================] - 2s 57ms/step - loss: 2.4133e-04 - mape: 42.5083 - val_loss: 2.4842e-04 - val_mape: 37.1613
Epoch 31/50
40/40 [==============================] - 2s 58ms/step - loss: 2.4324e-04 - mape: 43.3897 - val_loss: 2.7838e-04 - val_mape: 38.3288
Epoch 32/50
40/40 [==============================] - 2s 59ms/step - loss: 1.9017e-04 - mape: 39.0550 - val_loss: 2.9871e-04 - val_mape: 39.1297
Epoch 33/50
40/40 [==============================] - 2s 59ms/step - loss: 2.2482e-04 - mape: 40.4158 - val_loss: 3.0192e-04 - val_mape: 38.7419
Epoch 34/50
40/40 [==============================] - 2s 59ms/step - loss: 2.1657e-04 - mape: 40.3963 - val_loss: 3.5230e-04 - val_mape: 40.1646
Epoch 35/50
40/40 [==============================] - 2s 58ms/step - loss: 2.0805e-04 - mape: 39.7162 - val_loss: 3.1736e-04 - val_mape: 40.3662
Epoch 36/50
40/40 [==============================] - 2s 58ms/step - loss: 1.8435e-04 - mape: 40.0109 - val_loss: 3.3363e-04 - val_mape: 40.8310
Epoch 37/50
40/40 [==============================] - 2s 58ms/step - loss: 1.7170e-04 - mape: 38.2381 - val_loss: 3.2411e-04 - val_mape: 40.1198
Epoch 38/50
40/40 [==============================] - 2s 59ms/step - loss: 1.7347e-04 - mape: 38.6550 - val_loss: 3.2306e-04 - val_mape: 39.3539
Epoch 39/50
40/40 [==============================] - 2s 58ms/step - loss: 2.0698e-04 - mape: 39.9329 - val_loss: 3.5524e-04 - val_mape: 40.5177
Epoch 40/50
40/40 [==============================] - 2s 60ms/step - loss: 1.9913e-04 - mape: 40.5510 - val_loss: 3.4138e-04 - val_mape: 39.1442
Epoch 41/50
40/40 [==============================] - 2s 59ms/step - loss: 1.8010e-04 - mape: 40.0089 - val_loss: 3.6876e-04 - val_mape: 40.7033
Epoch 42/50
40/40 [==============================] - 2s 59ms/step - loss: 1.7004e-04 - mape: 37.6681 - val_loss: 3.2312e-04 - val_mape: 38.7067
Epoch 43/50
40/40 [==============================] - 2s 58ms/step - loss: 1.9030e-04 - mape: 39.2652 - val_loss: 3.4228e-04 - val_mape: 41.3261
Epoch 44/50
40/40 [==============================] - 2s 58ms/step - loss: 1.8507e-04 - mape: 38.5308 - val_loss: 3.1653e-04 - val_mape: 38.7843
Epoch 45/50
40/40 [==============================] - 2s 58ms/step - loss: 1.6754e-04 - mape: 37.5457 - val_loss: 2.7328e-04 - val_mape: 38.4415
Epoch 46/50
40/40 [==============================] - 2s 59ms/step - loss: 1.7267e-04 - mape: 39.0199 - val_loss: 7.3004e-04 - val_mape: 72.1474
Epoch 47/50
40/40 [==============================] - 2s 58ms/step - loss: 1.5308e-04 - mape: 37.5420 - val_loss: 3.0907e-04 - val_mape: 40.6367
Epoch 48/50
40/40 [==============================] - 2s 59ms/step - loss: 1.6427e-04 - mape: 38.4439 - val_loss: 3.0307e-04 - val_mape: 39.9768
Epoch 49/50
40/40 [==============================] - 2s 59ms/step - loss: 1.6695e-04 - mape: 37.5736 - val_loss: 2.9694e-04 - val_mape: 39.8486
Epoch 50/50
40/40 [==============================] - 2s 57ms/step - loss: 1.6130e-04 - mape: 38.0406 - val_loss: 2.9986e-04 - val_mape: 40.7513
7/7 [==============================] - 0s 6ms/step - loss: 2.9986e-04 - mape: 40.7513
[0.00029985944274812937, 40.751277923583984]
Lo que obtuvo la red fue:
[0.02569586 0.01413518 0.01878345 0.02489692]
El resultado correcto:
[0.0315  0.01625 0.01725 0.0325 ]